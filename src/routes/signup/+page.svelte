<script>
	import { store } from '$lib/js/store.js';
	import { href } from '$lib/js/href';
	import { onMount } from 'svelte';
  import { goto } from '$app/navigation';

  // let email
  let hash

  function showPass(node) {
    const rect = node.getBoundingClientRect()
 
    let top = rect.top
    let right = innerWidth - rect.right
    let size = node.clientHeight
    let status


    let eye = document.createElement("button")

    eye.style = `
    position: absolute;
    top:    ${top}px;
    right:  ${right}px;
    width:  ${size}px;
    height: ${size}px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    opacity: 0.7;
    `

    eye.innerText = "üôà"
    
    eye.addEventListener("click", () => {
      node.type = status ? "password" : "text"
      eye.innerText = status ? "üôà" : "üêµ" 

      status = !status
    })

    // let img = document.createElement("img")
    // img.src = ""

    // eye.append(img)
    node.after(eye)
  }


  onMount(() => {
    hash = location.hash.slice(1)
      addEventListener("hashchange", () => {
        hash = location.hash.slice(1)
      })
  })
  
</script>


<div class="h-full r-20 bg-$primary flex-col p-20">

  {#if hash === "confirm"}

    <div flex="15 col center grow" text="*:center">
      <h5 text="center">
        –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
      </h5>

      <p class="op-50 fs-14">
        –ú–∏ –≤—ñ–¥–ø—Ä–∞–≤–∏–ª–∏ –ª–∏—Å—Ç –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –Ω–∞ –≤–∫–∞–∑–∞–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É
      </p>

      <a class="btn mt-50" href="http://{$store.email}" target="_blank">
        –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ—à—Ç—É
      </a>

      <a href="#/" class="op-50 fs-14 mt-20 underline">
        –ó–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É
      </a>
    </div>

  {:else if  hash === "error"}

    <div flex="15 col center grow">
      <p>ERROR</p>
    </div>

  {:else}

    <div flex="15 col center grow">
      <h5 class="mb-20">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h5>

      <input type="text"     placeholder="–õ–æ–≥—ñ–Ω"   bind:value={$store.login}>
      <input type="email"    placeholder="–ï-–ü–æ—à—Ç–∞" bind:value={$store.email}>
      <input type="password" placeholder="–ü–∞—Ä–æ–ª—å"  bind:value={$store.passw} use:showPass  autocomplete="new-password">

      <div class="mt-10 fs-14 op-50">
        <a href="/signin">–£ –º–µ–Ω–µ –≤–∂–µ —î –∞–∫–∫–∞—É–Ω—Ç</a>
      </div>
    </div>

    <a href="#confirm" class="btn">–î–∞–ª—ñ</a>
    <!-- <button class="btn">–î–∞–ª—ñ</button> -->

  {/if}

</div>


